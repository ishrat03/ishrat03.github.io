<HTML>
<HEAD>
	<TITLE>Ajax Testing</TITLE>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/custom.css">
	</style>
</HEAD>
<BODY>
	<div class="nav">
		<a href="webpages/index.html" id="cookie"><span class="brand">Cookie</span></a>
		<ul class="nav-link">
			<li>Home</li>
		</ul>
	</div>
	<div>
		<center>
			<input type="text" placeholder="Enter text" id="text" class="py">
			<button id="submit" class="py-2">Convert</button>
		</center>
	</div>
	<center><h3 style="display: none;"><span id="apiText"></span></h3></center>
	
	<script type="text/javascript">
		$(document).ready(function()
		{
			audio('welcome.mp3');
			$('#submit').click(function()
			{
				initialFunction($('#text').val());
			})

			$('#cookie').on('mouseover', function()
			{
				audio('cookie.mp3');
			});
			
		})

		function ajaxRequest(url, data, method = 'POST')
		{
			$.ajax({
				url:url,
				type:method,
				dataType:'json',
				data:data,
				async:false,
				success:function(response)
				{
					document.cookie = "apiresponse="+response.html;
					document.cookie = "status=success";
					$('#apiText').html(response.html);
				},
				error:function(response)
				{
					console.log(response.statusCode);
				}
			})
		}

		function initialFunction(text)
		{
			var url = 'http://localhost/youtubetomp3/auth/api';
			var data = {text:text};
			ajaxRequest(url, data);
		}

		function audio(audio)
		{
			$('#apiText').html('<audio controls autoplay><source src="voice/'+audio+'" type="audio/mp3"></audio>');
		}
	</script>
</BODY>
<HTML>
